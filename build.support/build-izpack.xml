<?xml version="1.0" encoding="UTF-8"?>
<!-- $Id$ -->

<project default="izpack">

    <!-- A path containing the IzPack library -->
    <path id="izpack.classpath">
        <pathelement location="${izpack.jar}"/>
    </path>

    <!--
    #####################################################################
    IZPACK
    #####################################################################
    -->
    
    <target name="init.izpack">
        <echo level="verbose">izpack.jar=${izpack.jar}</echo>
        <fail message="Missing library ${izpack.jar}; check the 'izpack.jar' property in 'build.${user.name}.properties'.">
            <condition><not>
                <available classname="com.izforge.izpack.ant.IzPackTask"
                           classpathref="izpack.classpath"/>
            </not></condition>
        </fail>
        <taskdef name="izpack"
                 classname="com.izforge.izpack.ant.IzPackTask"
                 classpathref="izpack.classpath"/>
    </target>

    <target name="izpack" depends="izpack.unix"/>

<!--<target name="izpack.unix" depends="init.izpack, distrib.unix" -->
    <target name="izpack.unix" depends="init.izpack"
            description="Builds the Scala installer.">
        <property name="resource.dir" value="${build.dir}/izpack"/>
        <copy todir="${resource.dir}" overwrite="true">
            <fileset dir="${config.dir}/izpack"
                     excludes="**/*.html, **/*.xml"/>
        </copy>
        <copy todir="${resource.dir}" overwrite="true">
            <!-- CAUTION! Copy operations using filters will -->
            <!-- corrupt binary files (see "Core Types").    -->
            <fileset dir="${config.dir}/izpack"
                     includes="**/*.html, **/*.xml"/>
            <filterset>
                <filter token="RESOURCEDIR" value="${resource.dir}"/>
                <filter token="PREFIX"      value="${distrib.current.prefix}"/>
                <filter token="VERSION"     value="${scala.version}"/>
                <filter token="URL"         value="http://scala.epfl.ch/"/>
            </filterset>
        </copy>
        <izpack input="${resource.dir}/install-nsc.xml"
                output="${distrib.dir}/nscala-install-${scala.version}.jar"
                installerType="standard" basedir="${basedir}"/>
    </target>

</project>
